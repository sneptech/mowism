---
phase: 03-agent-teams-and-distribution
plan: 03
type: execute
wave: 2
depends_on:
  - "03-02"
files_modified:
  - help/new-project.md
  - help/resume-work.md
  - help/execute-phase.md
  - help/plan-phase.md
  - help/discuss-phase.md
  - help/research-phase.md
  - help/refine-phase.md
  - help/verify-work.md
  - help/progress.md
  - help/quick.md
  - help/help.md
  - help/map-codebase.md
  - help/add-phase.md
  - help/remove-phase.md
  - help/insert-phase.md
  - help/add-todo.md
  - help/check-todos.md
  - help/pause-work.md
  - help/settings.md
  - help/update.md
  - help/debug.md
  - help/worktree-status.md
  - help/team-status.md
  - help/migrate.md
  - help/reapply-patches.md
  - help/health.md
  - help/cleanup.md
  - help/set-profile.md
  - help/list-phase-assumptions.md
  - help/new-milestone.md
  - help/complete-milestone.md
  - help/audit-milestone.md
  - help/plan-milestone-gaps.md
  - commands/mow/help-open.md
  - commands/mow/new-project.md
  - commands/mow/resume-work.md
  - commands/mow/execute-phase.md
  - commands/mow/plan-phase.md
  - commands/mow/discuss-phase.md
  - commands/mow/research-phase.md
  - commands/mow/refine-phase.md
  - commands/mow/verify-work.md
  - commands/mow/progress.md
  - commands/mow/quick.md
  - commands/mow/help.md
  - commands/mow/map-codebase.md
  - commands/mow/add-phase.md
  - commands/mow/remove-phase.md
  - commands/mow/insert-phase.md
  - commands/mow/add-todo.md
  - commands/mow/check-todos.md
  - commands/mow/pause-work.md
  - commands/mow/settings.md
  - commands/mow/update.md
  - commands/mow/debug.md
  - commands/mow/worktree-status.md
  - commands/mow/migrate.md
  - commands/mow/reapply-patches.md
  - commands/mow/health.md
  - commands/mow/cleanup.md
  - commands/mow/set-profile.md
  - commands/mow/list-phase-assumptions.md
  - commands/mow/new-milestone.md
  - commands/mow/complete-milestone.md
  - commands/mow/audit-milestone.md
  - commands/mow/plan-milestone-gaps.md
autonomous: true
requirements:
  - DIST-02

must_haves:
  truths:
    - "User can type /mow:help-open execute-phase and the help file for execute-phase opens in $EDITOR"
    - "Help files contain user-friendly descriptions with usage examples and flag descriptions"
    - "When $EDITOR and $VISUAL are not set, fallback to nano then vi then less"
    - "All user-facing /mow:* commands have a corresponding help file"
    - "User can append ??? to any /mow:* command (e.g., /mow:execute-phase ???) and the help opens in $EDITOR via /mow:help-open"
  artifacts:
    - path: "commands/mow/help-open.md"
      provides: "??? help opener command"
      contains: "EDITOR"
    - path: "help/execute-phase.md"
      provides: "Example help file for execute-phase"
      contains: "Usage"
    - path: "help/new-project.md"
      provides: "Help file for new-project"
      contains: "Usage"
  key_links:
    - from: "commands/mow/help-open.md"
      to: "help/*.md"
      via: "file path construction from command name argument"
      pattern: "help/"
    - from: "commands/mow/help-open.md"
      to: "$EDITOR"
      via: "VISUAL -> EDITOR -> nano -> vi -> less fallback chain"
      pattern: "VISUAL.*EDITOR.*nano"
    - from: "commands/mow/*.md"
      to: "commands/mow/help-open.md"
      via: "??? detection in $ARGUMENTS routes to /mow:help-open"
      pattern: "\\?\\?\\?"
---

<objective>
Create the ??? help system: a /mow:help-open command, user-friendly help files for all /mow:* commands, and ??? detection wiring in every command file.

Purpose: Users can learn any command without leaving the terminal by appending ??? or using /mow:help-open. Per locked decision, help files are user-friendly (not raw workflow markdown) with usage examples and flag descriptions. DIST-02 requires that "??? suffix on any /mow:* command" works, which means each command file must detect ??? and route to help-open.

Output: commands/mow/help-open.md (the ??? handler), help/ directory with ~32 help files, ??? detection added to all command .md files.
</objective>

<execution_context>
@/home/max/.claude/get-shit-done/workflows/execute-plan.md
@/home/max/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-agent-teams-and-distribution/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /mow:help-open command</name>
  <files>commands/mow/help-open.md</files>
  <action>
  Create `commands/mow/help-open.md` as a Claude Code command that opens help files in the user's editor.

  Frontmatter:
  ```yaml
  ---
  name: mow:help-open
  description: Open help documentation for a /mow:* command in your editor
  argument-hint: "<command-name>"
  allowed-tools:
    - Bash
    - Read
  ---
  ```

  The command should:
  1. Take the command name from `$ARGUMENTS` (e.g., "execute-phase", "new-project")
  2. Strip any leading "mow:" prefix if the user typed `/mow:help-open mow:execute-phase`
  3. Strip any "???" if the user typed it as part of the argument
  4. Construct the help file path: `~/.claude/mowism/help/{command-name}.md`
  5. Check if the help file exists. If not, tell the user which commands have help files available.
  6. Open the file using the $EDITOR fallback chain. The command instructs Claude to run:
     ```bash
     HELP_FILE="$HOME/.claude/mowism/help/{command-name}.md"
     if [ -f "$HELP_FILE" ]; then
       EDIT_CMD="${VISUAL:-${EDITOR:-$(command -v nano 2>/dev/null || command -v vi 2>/dev/null || command -v less 2>/dev/null || echo cat)}}"
       $EDIT_CMD "$HELP_FILE"
     fi
     ```
  7. If no argument provided, list all available help files with their one-line descriptions.

  Per locked decision: open dedicated help files in $EDITOR (not raw workflow markdown).
  Per discretion: $EDITOR fallback chain is $VISUAL -> $EDITOR -> nano -> vi -> less -> cat.
  </action>
  <verify>Read the created file and confirm it has proper frontmatter, handles missing arguments, constructs the correct help file path, and uses the editor fallback chain.</verify>
  <done>/mow:help-open command file exists with proper frontmatter, argument parsing, editor fallback chain, and file existence checking.</done>
</task>

<task type="auto">
  <name>Task 2: Create help files for all user-facing commands</name>
  <files>help/new-project.md, help/resume-work.md, help/execute-phase.md, help/plan-phase.md, help/discuss-phase.md, help/research-phase.md, help/refine-phase.md, help/verify-work.md, help/progress.md, help/quick.md, help/help.md, help/map-codebase.md, help/add-phase.md, help/remove-phase.md, help/insert-phase.md, help/add-todo.md, help/check-todos.md, help/pause-work.md, help/settings.md, help/update.md, help/debug.md, help/worktree-status.md, help/team-status.md, help/migrate.md, help/reapply-patches.md, help/health.md, help/cleanup.md, help/set-profile.md, help/list-phase-assumptions.md, help/new-milestone.md, help/complete-milestone.md, help/audit-milestone.md, help/plan-milestone-gaps.md</files>
  <action>
  Create `help/` directory at repo root with one help file per user-facing /mow:* command. Each file follows this format (from research):

  ```markdown
  # /mow:{command-name}

  {One-line description}

  ## Usage

    /mow:{command-name} {args}

  ## Arguments

    {arg}    {description}

  ## Flags

    {flag}   {description}

  ## What Happens

  {3-5 numbered steps describing the workflow}

  ## Examples

    /mow:{command-name} {example}    {what it does}

  ## Related

    /mow:{related-command}    {brief description}
  ```

  Create help files for all 32+ commands. Derive content from the installed command files at `~/.claude/commands/mow/` and workflows at `~/.claude/mowism/workflows/`. Each help file should be 20-40 lines, user-friendly, with real usage examples.

  **Per discretion recommendation:** All user-facing commands get help files (~32 files). Group by category as listed in research:
  - Core workflows (12): new-project, resume-work, execute-phase, plan-phase, discuss-phase, research-phase, refine-phase, verify-work, progress, quick, help, map-codebase
  - Management (8): add-phase, remove-phase, insert-phase, add-todo, check-todos, pause-work, settings, update
  - Advanced (5): debug, worktree-status, team-status, migrate, reapply-patches
  - Milestone (4): new-milestone, complete-milestone, audit-milestone, plan-milestone-gaps
  - Meta (3): health, cleanup, set-profile, list-phase-assumptions

  This is a mechanical task: read each command's frontmatter (name, description, argument-hint) and the workflow it references, then write a user-friendly summary.

  Per locked decision: help files contain user-friendly content with usage examples and flag descriptions, NOT the raw workflow markdown.
  </action>
  <verify>Count help files: `ls help/*.md | wc -l` should be >= 32. Spot-check 3 files (help/execute-phase.md, help/new-project.md, help/refine-phase.md) for correct format.</verify>
  <done>help/ directory contains 32+ help files, each with Usage, Arguments/Flags, What Happens, Examples, and Related sections. All user-facing /mow:* commands have a corresponding help file.</done>
</task>

<task type="auto">
  <name>Task 3: Add ??? detection to all /mow:* command files</name>
  <files>commands/mow/new-project.md, commands/mow/resume-work.md, commands/mow/execute-phase.md, commands/mow/plan-phase.md, commands/mow/discuss-phase.md, commands/mow/research-phase.md, commands/mow/refine-phase.md, commands/mow/verify-work.md, commands/mow/progress.md, commands/mow/quick.md, commands/mow/help.md, commands/mow/map-codebase.md, commands/mow/add-phase.md, commands/mow/remove-phase.md, commands/mow/insert-phase.md, commands/mow/add-todo.md, commands/mow/check-todos.md, commands/mow/pause-work.md, commands/mow/settings.md, commands/mow/update.md, commands/mow/debug.md, commands/mow/worktree-status.md, commands/mow/migrate.md, commands/mow/reapply-patches.md, commands/mow/health.md, commands/mow/cleanup.md, commands/mow/set-profile.md, commands/mow/list-phase-assumptions.md, commands/mow/new-milestone.md, commands/mow/complete-milestone.md, commands/mow/audit-milestone.md, commands/mow/plan-milestone-gaps.md</files>
  <action>
  Modify every /mow:* command file under `commands/mow/` (except help-open.md itself) to detect "???" in `$ARGUMENTS` and route to `/mow:help-open`. This is required for DIST-02: "??? suffix on any /mow:* command opens help in $EDITOR."

  For each command file, add a ??? detection block immediately after the frontmatter closing `---`, BEFORE the existing command body. The block should be:

  ```markdown
  **??? Help Detection:**
  If `$ARGUMENTS` contains "???" (e.g., the user typed `/mow:{command-name} ???`):
  1. Extract the command name from this file's name: `{command-name}`
  2. Run `/mow:help-open {command-name}` to open the help file in the user's editor
  3. Stop here -- do NOT proceed with the normal command execution below
  ```

  This is a mechanical edit across all ~32 command files. The pattern is identical for every file -- only the command name changes.

  **Implementation approach:**
  - Read each command file in `commands/mow/`
  - For each file (except help-open.md), insert the ??? detection block after the frontmatter `---` closing line
  - The command name is derived from the filename (e.g., `execute-phase.md` -> `execute-phase`)
  - Do NOT modify help-open.md (it already handles ??? in its argument parsing)

  **Important:** These command files are Claude Code command definitions (markdown files with YAML frontmatter). The ??? detection block is an instruction to Claude, not executable code. It tells Claude to check $ARGUMENTS for "???" before proceeding with the normal command workflow.
  </action>
  <verify>Read 3 command files (commands/mow/execute-phase.md, commands/mow/new-project.md, commands/mow/refine-phase.md) and confirm each has the ??? detection block after frontmatter. Grep for "???" across commands/mow/ to confirm coverage: `grep -l '???' commands/mow/*.md | wc -l` should be >= 31 (all except help-open.md which handles ??? differently).</verify>
  <done>All /mow:* command files (except help-open.md) contain ??? detection that routes to /mow:help-open. User can type `/mow:execute-phase ???` and get the help file opened in $EDITOR instead of the normal command execution.</done>
</task>

</tasks>

<verification>
- `ls help/*.md | wc -l` >= 32
- commands/mow/help-open.md exists with proper frontmatter
- help/execute-phase.md contains "Usage", "Examples", "Related" sections
- help/new-project.md contains "Usage" section
- `grep -l '???' commands/mow/*.md | wc -l` >= 31 (all commands have ??? detection)
- commands/mow/execute-phase.md contains ??? detection block before normal command body
</verification>

<success_criteria>
- /mow:help-open command exists and handles argument parsing + editor fallback
- All 32+ user-facing commands have corresponding help files in help/
- Help files are user-friendly with examples, not raw workflow copies
- Help files follow consistent format across all commands
- All /mow:* command files detect ??? in $ARGUMENTS and route to /mow:help-open (DIST-02 fulfilled)
</success_criteria>

<output>
After completion, create `.planning/phases/03-agent-teams-and-distribution/03-03-SUMMARY.md`
</output>
